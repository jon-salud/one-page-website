<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>One Page Website</title>
    <link rel="stylesheet" href="styles.css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"
    />
  </head>

  <body>
    <header>
      <h1>Welcome to My One Page Website</h1>
    </header>
    <div class="container">
      <section id="about" class="section">
        <h2>About</h2>
        <p>
          This page is designed to test various UI behaviors for demoing UI
          Functional automation using Playwright. It includes elements such as
          search fields with delayed dropdowns, calendar fields, login fields
          with modal notifications, date and time fields, and a paginated table.
        </p>
      </section>
      <section id="search" class="section">
        <h2>Search</h2>
        <p>
          Instruction: Key in your search criteria (e.g., "test") then select
          via mouse click or arrow keys and tab out.
        </p>
        <input type="text" id="searchField" placeholder="Search..." />
        <div id="searchResults"></div>
      </section>
      <section id="calendar" class="section">
        <h2>Calendar</h2>
        <p>
          Instruction: Click on the input field to select a date from the
          calendar.
        </p>
        <input type="text" id="calendarField" placeholder="Select a date" />
      </section>
      <section id="login" class="section">
        <h2>Login</h2>
        <p>
          Instruction: Enter the username "userone" and the password "pwordone".
          Any other values will raise an error modal notification.
        </p>
        <input type="text" id="username" placeholder="Username" />
        <input type="password" id="password" placeholder="Password" />
        <button id="loginButton">Login</button>
        <div id="loginModal" class="modal">
          <div class="modal-content">
            <span class="close">&times;</span>
            <p id="modalMessage"></p>
          </div>
        </div>
      </section>
      <section id="datetime" class="section">
        <h2>Date and Time</h2>
        <p>Instruction: Click on the input fields to select a date and time.</p>
        <input type="text" id="dateField" placeholder="Select a date" />
        <input type="text" id="timeField" placeholder="Select a time" />
      </section>
      <section id="table" class="section">
        <h2>Table</h2>
        <p>
          Instruction: Use the "Previous" and "Next" buttons to navigate through
          the table pages.
        </p>
        <table id="dataTable">
          <thead>
            <tr>
              <th>ID</th>
              <th>Name</th>
              <th>Value</th>
            </tr>
          </thead>
          <tbody>
            <!-- Sample data rows will be generated by script -->
          </tbody>
        </table>
        <div class="pagination">
          <button id="prevPage">Previous</button>
          <button id="nextPage">Next</button>
        </div>
      </section>
    </div>
    <footer>
      <p>&copy; 2023 My One Page Website</p>
    </footer>
    <script src="script.js"></script>
    <script>
      $(document).ready(function () {
        // Sample data for search
        const searchData = [
          "test",
          "testing",
          "tester",
          "template",
          "temporary",
          "attempt",
          "contest",
          "detest",
          "protest",
          "context",
        ];

        let selectedIndex = -1;

        // Search field with delayed dropdown
        $("#searchField").on("input", function () {
          let query = $(this).val().toLowerCase();
          if (query.length > 1) {
            setTimeout(function () {
              let results = searchData.filter((item) => item.includes(query));
              if (results.length > 0) {
                $("#searchResults")
                  .html(
                    results
                      .map(
                        (item, index) =>
                          `<p class="search-item" data-index="${index}">${item}</p>`,
                      )
                      .join(""),
                  )
                  .show();
                selectedIndex = -1;
              } else {
                $("#searchResults").html("<p>No results found</p>").show();
              }
            }, 500);
          } else {
            $("#searchResults").hide();
          }
        });

        // Handle keyboard navigation
        $("#searchField").on("keydown", function (e) {
          let items = $("#searchResults .search-item");
          if (items.length > 0) {
            if (e.key === "ArrowDown") {
              selectedIndex = (selectedIndex + 1) % items.length;
              items.removeClass("selected");
              $(items[selectedIndex]).addClass("selected");
            } else if (e.key === "ArrowUp") {
              selectedIndex = (selectedIndex - 1 + items.length) % items.length;
              items.removeClass("selected");
              $(items[selectedIndex]).addClass("selected");
            } else if (e.key === "Enter") {
              if (selectedIndex >= 0) {
                $("#searchField").val($(items[selectedIndex]).text());
                $("#searchResults").hide();
              }
            }
          }
        });

        // Handle mouse click selection
        $(document).on("click", ".search-item", function () {
          $("#searchField").val($(this).text());
          $("#searchResults").hide();
        });

        // Handle tab out action
        $("#searchField").on("blur", function () {
          let items = $("#searchResults .search-item");
          if (items.length > 0) {
            if (selectedIndex === -1) {
              selectedIndex = 0;
            }
            $("#searchField").val($(items[selectedIndex]).text());
            $("#searchResults").hide();
          }
        });

        // Calendar field
        flatpickr("#calendarField", {});

        // Date and time fields
        flatpickr("#dateField", { dateFormat: "Y-m-d" });
        flatpickr("#timeField", {
          enableTime: true,
          noCalendar: true,
          dateFormat: "H:i",
        });

        // Login modal
        $("#loginButton").on("click", function () {
          let username = $("#username").val();
          let password = $("#password").val();
          if (username !== "userone" || password !== "pwordone") {
            $("#modalMessage").text("Invalid username or password");
            $("#loginModal").show();
          }
        });
        $(".close").on("click", function () {
          $("#loginModal").hide();
        });

        // Table with pagination
        let data = [];
        for (let i = 1; i <= 35; i++) {
          data.push({ id: i, name: "Name " + i, value: "Value " + i });
        }
        let currentPage = 1;
        let rowsPerPage = 10;

        function renderTable(page) {
          let start = (page - 1) * rowsPerPage;
          let end = start + rowsPerPage;
          let rows = data.slice(start, end);
          let tbody = $("#dataTable tbody");
          tbody.empty();
          rows.forEach((row) => {
            tbody.append(
              "<tr><td>" +
                row.id +
                "</td><td>" +
                row.name +
                "</td><td>" +
                row.value +
                "</td></tr>",
            );
          });
        }

        $("#prevPage").on("click", function () {
          if (currentPage > 1) {
            currentPage--;
            renderTable(currentPage);
          }
        });

        $("#nextPage").on("click", function () {
          if (currentPage < Math.ceil(data.length / rowsPerPage)) {
            currentPage++;
            renderTable(currentPage);
          }
        });

        renderTable(currentPage);
      });
    </script>
  </body>
</html>
